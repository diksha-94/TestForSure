package edu.tests.TestForSure.datalayer;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;

import edu.tests.TestForSure.common.DBConnection;
import edu.tests.TestForSure.entity.TestReports;
import edu.tests.TestForSure.sql.CreateTestQueries;

public class TestReportDAO {

	public static Boolean getTestReport(int test_id, String email_id){
		System.out.println("Calling DAO");
		//this query is to check whether the test is already attempted by particular user or to get all the reports of a user for a particular test
		String query = CreateTestQueries.checkAlreadyAttempted(test_id, email_id);
		System.out.println("Query: "+query);
		Connection conn = DBConnection.getDBConnection();
		ResultSet rs = null;
		Boolean response = false;
		TestReports report = null;
		try{
			Statement statement = conn.createStatement();
			rs = statement.executeQuery(query);
			if(rs.isBeforeFirst()){
				while(rs.next()){
					report = new TestReports();
					report.setId(rs.getInt(1));
					report.setTest_id(rs.getInt(2));
					report.setUsername(username);
					report.setEmailid(emailid);
					report.setMobile_number(mobile_number);
					report.setMarks_scored(marks_scored);
					report.setTime_taken(time_taken);
					report.setRank(rank);
					report.setQuestions_attempted(questions_attempted);
					report.setCorrect_ques(correct_ques);
					report.setIncorrect_ques(incorrect_ques);
				}
			}
		}
		catch(Exception e){
			System.out.println("Exception from DAO: "+e.getMessage());
			response = false;
		}
		
		return response;
	}
}
